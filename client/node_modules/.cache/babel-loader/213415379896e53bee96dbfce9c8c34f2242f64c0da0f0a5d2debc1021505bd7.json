{"ast":null,"code":"// Stable initial shape so first render never crashes\nconst initialState = {\n  user: {\n    _id: null,\n    username: \"\",\n    email: \"\",\n    friends: [],\n    expensis: [] // we'll use this as our canonical client-side list\n  }\n};\nexport const userReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case \"AddUser\":\n      {\n        const doc = action.payload || {};\n        const incoming = doc.user && (doc.user.username || doc.user.friends || doc.user.expensis) ? doc.user : doc;\n        return {\n          user: {\n            ...state.user,\n            ...incoming,\n            friends: Array.isArray(incoming.friends) ? incoming.friends : state.user.friends,\n            // if server sends either \"expensis\" or \"expenses\", normalize into \"expensis\"\n            expensis: Array.isArray(incoming.expensis) ? incoming.expensis : Array.isArray(incoming.expenses) ? incoming.expenses : state.user.expensis\n          }\n        };\n      }\n\n    // Append one or many items locally so UI updates immediately\n    case \"APPEND_EXPENSES\":\n      {\n        const add = Array.isArray(action.payload) ? action.payload : [action.payload];\n        return {\n          user: {\n            ...state.user,\n            expensis: [...state.user.expensis, ...add]\n          }\n        };\n      }\n\n    // Optional: clear temp items (if you ever want to)\n    case \"CLEAR_TEMP_EXPENSES\":\n      {\n        return {\n          user: {\n            ...state.user,\n            expensis: state.user.expensis.filter(x => !(x && String(x._id || \"\").startsWith(\"temp-\")))\n          }\n        };\n      }\n    case \"LOGOUT\":\n      return initialState;\n    default:\n      return state;\n  }\n};","map":{"version":3,"names":["initialState","user","_id","username","email","friends","expensis","userReducer","state","action","type","doc","payload","incoming","Array","isArray","expenses","add","filter","x","String","startsWith"],"sources":["/Users/queen/Downloads/Budget Tracker/client/src/redux/reducers/userReducer.js"],"sourcesContent":["// Stable initial shape so first render never crashes\r\nconst initialState = {\r\n  user: {\r\n    _id: null,\r\n    username: \"\",\r\n    email: \"\",\r\n    friends: [],\r\n    expensis: [], // we'll use this as our canonical client-side list\r\n  },\r\n};\r\n\r\nexport const userReducer = (state = initialState, action) => {\r\n  switch (action.type) {\r\n    case \"AddUser\": {\r\n      const doc = action.payload || {};\r\n      const incoming =\r\n        doc.user && (doc.user.username || doc.user.friends || doc.user.expensis)\r\n          ? doc.user\r\n          : doc;\r\n\r\n      return {\r\n        user: {\r\n          ...state.user,\r\n          ...incoming,\r\n          friends: Array.isArray(incoming.friends)\r\n            ? incoming.friends\r\n            : state.user.friends,\r\n          // if server sends either \"expensis\" or \"expenses\", normalize into \"expensis\"\r\n          expensis: Array.isArray(incoming.expensis)\r\n            ? incoming.expensis\r\n            : Array.isArray(incoming.expenses)\r\n            ? incoming.expenses\r\n            : state.user.expensis,\r\n        },\r\n      };\r\n    }\r\n\r\n    // Append one or many items locally so UI updates immediately\r\n    case \"APPEND_EXPENSES\": {\r\n      const add = Array.isArray(action.payload)\r\n        ? action.payload\r\n        : [action.payload];\r\n      return {\r\n        user: {\r\n          ...state.user,\r\n          expensis: [...state.user.expensis, ...add],\r\n        },\r\n      };\r\n    }\r\n\r\n    // Optional: clear temp items (if you ever want to)\r\n    case \"CLEAR_TEMP_EXPENSES\": {\r\n      return {\r\n        user: {\r\n          ...state.user,\r\n          expensis: state.user.expensis.filter(\r\n            (x) => !(x && String(x._id || \"\").startsWith(\"temp-\"))\r\n          ),\r\n        },\r\n      };\r\n    }\r\n\r\n    case \"LOGOUT\":\r\n      return initialState;\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n"],"mappings":"AAAA;AACA,MAAMA,YAAY,GAAG;EACnBC,IAAI,EAAE;IACJC,GAAG,EAAE,IAAI;IACTC,QAAQ,EAAE,EAAE;IACZC,KAAK,EAAE,EAAE;IACTC,OAAO,EAAE,EAAE;IACXC,QAAQ,EAAE,EAAE,CAAE;EAChB;AACF,CAAC;AAED,OAAO,MAAMC,WAAW,GAAGA,CAACC,KAAK,GAAGR,YAAY,EAAES,MAAM,KAAK;EAC3D,QAAQA,MAAM,CAACC,IAAI;IACjB,KAAK,SAAS;MAAE;QACd,MAAMC,GAAG,GAAGF,MAAM,CAACG,OAAO,IAAI,CAAC,CAAC;QAChC,MAAMC,QAAQ,GACZF,GAAG,CAACV,IAAI,KAAKU,GAAG,CAACV,IAAI,CAACE,QAAQ,IAAIQ,GAAG,CAACV,IAAI,CAACI,OAAO,IAAIM,GAAG,CAACV,IAAI,CAACK,QAAQ,CAAC,GACpEK,GAAG,CAACV,IAAI,GACRU,GAAG;QAET,OAAO;UACLV,IAAI,EAAE;YACJ,GAAGO,KAAK,CAACP,IAAI;YACb,GAAGY,QAAQ;YACXR,OAAO,EAAES,KAAK,CAACC,OAAO,CAACF,QAAQ,CAACR,OAAO,CAAC,GACpCQ,QAAQ,CAACR,OAAO,GAChBG,KAAK,CAACP,IAAI,CAACI,OAAO;YACtB;YACAC,QAAQ,EAAEQ,KAAK,CAACC,OAAO,CAACF,QAAQ,CAACP,QAAQ,CAAC,GACtCO,QAAQ,CAACP,QAAQ,GACjBQ,KAAK,CAACC,OAAO,CAACF,QAAQ,CAACG,QAAQ,CAAC,GAChCH,QAAQ,CAACG,QAAQ,GACjBR,KAAK,CAACP,IAAI,CAACK;UACjB;QACF,CAAC;MACH;;IAEA;IACA,KAAK,iBAAiB;MAAE;QACtB,MAAMW,GAAG,GAAGH,KAAK,CAACC,OAAO,CAACN,MAAM,CAACG,OAAO,CAAC,GACrCH,MAAM,CAACG,OAAO,GACd,CAACH,MAAM,CAACG,OAAO,CAAC;QACpB,OAAO;UACLX,IAAI,EAAE;YACJ,GAAGO,KAAK,CAACP,IAAI;YACbK,QAAQ,EAAE,CAAC,GAAGE,KAAK,CAACP,IAAI,CAACK,QAAQ,EAAE,GAAGW,GAAG;UAC3C;QACF,CAAC;MACH;;IAEA;IACA,KAAK,qBAAqB;MAAE;QAC1B,OAAO;UACLhB,IAAI,EAAE;YACJ,GAAGO,KAAK,CAACP,IAAI;YACbK,QAAQ,EAAEE,KAAK,CAACP,IAAI,CAACK,QAAQ,CAACY,MAAM,CACjCC,CAAC,IAAK,EAAEA,CAAC,IAAIC,MAAM,CAACD,CAAC,CAACjB,GAAG,IAAI,EAAE,CAAC,CAACmB,UAAU,CAAC,OAAO,CAAC,CACvD;UACF;QACF,CAAC;MACH;IAEA,KAAK,QAAQ;MACX,OAAOrB,YAAY;IAErB;MACE,OAAOQ,KAAK;EAChB;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}